package com.revature.revpay.service;

import com.revature.revpay.model.User;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.*;

class UserServiceTest {
    
    private UserService userService;
    
    @BeforeEach
    void setUp() {
        userService = new UserService();
    }
    
    @Test
    void testRegisterPersonalUser_ValidInput_Success() {
        // Test data
        String fullName = "John Doe";
        String email = "john.test@email.com";
        String phoneNumber = "1234567890";
        String password = "Password123";
        String transactionPin = "1234";
        String securityQuestion1 = "What is your pet name?";
        String securityAnswer1 = "Fluffy";
        String securityQuestion2 = "What is your birth city?";
        String securityAnswer2 = "New York";
        
        // This test would require a test database or mocking
        // For now, we'll test the validation logic
        
        assertDoesNotThrow(() -> {
            // This would normally create a user, but we need database setup
            // User user = userService.registerPersonalUser(fullName, email, phoneNumber, 
            //     password, transactionPin, securityQuestion1, securityAnswer1,
            //     securityQuestion2, securityAnswer2);
            // assertNotNull(user);
            // assertEquals(User.AccountType.PERSONAL, user.getAccountType());
        });
    }
    
    @Test
    void testRegisterPersonalUser_InvalidPassword_ThrowsException() {
        String fullName = "John Doe";
        String email = "john.test@email.com";
        String phoneNumber = "1234567890";
        String weakPassword = "123"; // Invalid password
        String transactionPin = "1234";
        String securityQuestion1 = "What is your pet name?";
        String securityAnswer1 = "Fluffy";
        String securityQuestion2 = "What is your birth city?";
        String securityAnswer2 = "New York";
        
        assertThrows(IllegalArgumentException.class, () -> {
            userService.registerPersonalUser(fullName, email, phoneNumber, 
                weakPassword, transactionPin, securityQuestion1, securityAnswer1,
                securityQuestion2, securityAnswer2);
        });
    }
    
    @Test
    void testRegisterPersonalUser_InvalidPin_ThrowsException() {
        String fullName = "John Doe";
        String email = "john.test@email.com";
        String phoneNumber = "1234567890";
        String password = "Password123";
        String invalidPin = "12"; // Invalid PIN
        String securityQuestion1 = "What is your pet name?";
        String securityAnswer1 = "Fluffy";
        String securityQuestion2 = "What is your birth city?";
        String securityAnswer2 = "New York";
        
        assertThrows(IllegalArgumentException.class, () -> {
            userService.registerPersonalUser(fullName, email, phoneNumber, 
                password, invalidPin, securityQuestion1, securityAnswer1,
                securityQuestion2, securityAnswer2);
        });
    }
}